# YOLOv8ä¼˜åŒ–ç¤ºä¾‹é¡¹ç›®
# ===================

"""
YOLOv8ä¼˜åŒ–æ–¹æ³•çš„å®Œæ•´å®ç°å’Œåº”ç”¨ç¤ºä¾‹

æœ¬é¡¹ç›®æä¾›äº†ä¸‰ç§ä¸»è¦çš„YOLOv8ä¼˜åŒ–æ–¹æ³•ï¼š

ğŸ”¬ DCN (å¯å˜å½¢å·ç§¯ç½‘ç»œ/Deformable Convolutional Network)
   - æ ¸å¿ƒæ€æƒ³ï¼šå­¦ä¹ å·ç§¯æ ¸çš„ç©ºé—´åç§»ï¼Œå®ç°å‡ ä½•å˜æ¢å»ºæ¨¡
   - é€‚ç”¨åœºæ™¯ï¼šå¤„ç†å¯å˜å½¢ç‰©ä½“ã€å¤æ‚å‡ ä½•å½¢çŠ¶çš„æ£€æµ‹ä»»åŠ¡
   - æŠ€æœ¯ä¼˜åŠ¿ï¼šæå‡å¯¹éåˆšæ€§ç‰©ä½“çš„æ£€æµ‹ç²¾åº¦

ğŸ§  SCC (ç©ºé—´-é€šé“äº¤å‰æ³¨æ„åŠ›/Spatial-Channel Cross Attention)
   - æ ¸å¿ƒæ€æƒ³ï¼šç»“åˆç©ºé—´æ³¨æ„åŠ›å’Œé€šé“æ³¨æ„åŠ›è¿›è¡Œç‰¹å¾é‡æ ‡å®š
   - é€‚ç”¨åœºæ™¯ï¼šéœ€è¦æ³¨æ„åŠ›å¢å¼ºçš„ç‰¹å¾æå–ä»»åŠ¡
   - æŠ€æœ¯ä¼˜åŠ¿ï¼šåŸºäºCBAMæ¶æ„ï¼Œè½»é‡çº§é«˜æ•ˆç‡

âš¡ DCN + SCC ç»„åˆä¼˜åŒ–
   - æ ¸å¿ƒæ€æƒ³ï¼šå°†å‡ ä½•å»ºæ¨¡å’Œæ³¨æ„åŠ›æœºåˆ¶ç›¸ç»“åˆ
   - é€‚ç”¨åœºæ™¯ï¼šå¯¹æ£€æµ‹ç²¾åº¦è¦æ±‚æé«˜çš„å¤æ‚åº”ç”¨
   - æŠ€æœ¯ä¼˜åŠ¿ï¼šä¸¤ç§æœºåˆ¶çš„ååŒæ•ˆåº”ï¼Œå®ç°æ€§èƒ½æœ€ä¼˜åŒ–

ğŸ—ï¸ é¡¹ç›®æ¶æ„ç‰¹ç‚¹ï¼š
   - æ¨¡å—åŒ–è®¾è®¡ï¼šæ¯ä¸ªä¼˜åŒ–æ–¹æ³•ç‹¬ç«‹æˆæ¨¡å—
   - ç»Ÿä¸€æ¥å£ï¼šæ‰€æœ‰æ–¹æ³•ä½¿ç”¨ç›¸åŒçš„APIè®¾è®¡
   - å³æ’å³ç”¨ï¼šæ”¯æŒè¿è¡Œæ—¶åŠ¨æ€æ›¿æ¢æ¨¡å‹ç»„ä»¶
   - å®Œæ•´å·¥å…·é“¾ï¼šä»æ¨¡å‹åˆ›å»ºåˆ°æ€§èƒ½è¯„ä¼°çš„å…¨æµç¨‹æ”¯æŒ

ğŸ“¦ æ ¸å¿ƒåŠŸèƒ½ï¼š
   1. æ¨¡å—åŒ–å®ç°ï¼šæ¯ä¸ªä¼˜åŒ–æ–¹æ³•éƒ½æœ‰ç‹¬ç«‹çš„å®Œæ•´å®ç°
   2. è®­ç»ƒç¤ºä¾‹ï¼šåŒ…å«å®Œæ•´çš„è®­ç»ƒæµç¨‹å’Œé…ç½®
   3. è¯„ä¼°å·¥å…·ï¼šæ€§èƒ½æµ‹è¯•å’Œå¯¹æ¯”åˆ†æåŠŸèƒ½
   4. è¿è¡Œæ—¶ä¿®æ”¹ï¼šæ”¯æŒç°æœ‰æ¨¡å‹çš„åŠ¨æ€ä¼˜åŒ–
   5. æ¶ˆèå®éªŒï¼šç§‘å­¦çš„æ€§èƒ½å¯¹æ¯”å’Œåˆ†ææ–¹æ³•

ğŸ¯ åº”ç”¨ä»·å€¼ï¼š
   - å­¦æœ¯ç ”ç©¶ï¼šä¸ºç›®æ ‡æ£€æµ‹ä¼˜åŒ–æä¾›æ–°çš„ç ”ç©¶æ–¹å‘
   - å·¥ä¸šåº”ç”¨ï¼šæå‡å®é™…åœºæ™¯ä¸­çš„æ£€æµ‹æ€§èƒ½
   - æŠ€æœ¯éªŒè¯ï¼šéªŒè¯æ–°ä¼˜åŒ–æ–¹æ³•çš„æœ‰æ•ˆæ€§
   - æ€§èƒ½åŸºå‡†ï¼šå»ºç«‹ä¼˜åŒ–æ–¹æ³•çš„æ€§èƒ½åŸºå‡†çº¿

ğŸ’¡ ä½¿ç”¨å»ºè®®ï¼š
   - DCNé€‚ç”¨äºå‡ ä½•å˜æ¢å¤æ‚çš„åœºæ™¯
   - SCCé€‚ç”¨äºéœ€è¦ç²¾ç»†ç‰¹å¾å¤„ç†çš„åœºæ™¯
   - ç»„åˆä¼˜åŒ–é€‚ç”¨äºå¯¹æ€§èƒ½è¦æ±‚æé«˜çš„åº”ç”¨
   - å¯ä»¥æ ¹æ®å…·ä½“éœ€æ±‚é€‰æ‹©åˆé€‚çš„ä¼˜åŒ–ç­–ç•¥
"""

__version__ = "1.0.0"
__author__ = "YOLOv8ä¼˜åŒ–å›¢é˜Ÿ"
__description__ = "åŒ…å«DCNã€SCCå’Œç»„åˆä¼˜åŒ–æ–¹æ³•çš„YOLOv8ä¼˜åŒ–ç¤ºä¾‹"

# å­æ¨¡å—å¯¼å…¥ - å»ºç«‹å®Œæ•´çš„æ¨¡å—ä¾èµ–å…³ç³»
from . import utils              # å·¥å…·æ¨¡å—ï¼šè®¾å¤‡ç®¡ç†ã€æ¨¡å‹åˆ†æã€æ€§èƒ½æµ‹è¯•
from . import dcn               # DCNæ¨¡å—ï¼šå¯å˜å½¢å·ç§¯ç½‘ç»œä¼˜åŒ–
from . import scc               # SCCæ¨¡å—ï¼šç©ºé—´-é€šé“äº¤å‰æ³¨æ„åŠ›ä¼˜åŒ–
from . import dcn_scc_combined  # ç»„åˆæ¨¡å—ï¼šDCN+SCCè”åˆä¼˜åŒ–

# æ ¸å¿ƒåŠŸèƒ½çš„ä¾¿æ·å¯¼å…¥ - æä¾›å¸¸ç”¨APIçš„å¿«é€Ÿè®¿é—®
from .dcn import DCN_C2f, replace_c2f_with_dcn, train_dcn_model
from .scc import SCC_C2f, replace_c2f_with_scc, train_scc_model
from .dcn_scc_combined import DCN_SCC_C2f, replace_c2f_with_dcn_scc, train_combined_model

__all__ = [
    # å­æ¨¡å—
    'utils',
    'dcn',
    'scc',
    'dcn_scc_combined',

    # å…³é”®ç±»
    'DCN_C2f',
    'SCC_C2f',
    'DCN_SCC_C2f',

    # å…³é”®å‡½æ•°
    'replace_c2f_with_dcn',
    'replace_c2f_with_scc',
    'replace_c2f_with_dcn_scc',
    'train_dcn_model',
    'train_scc_model',
    'train_combined_model'
]

def get_available_methods():
    """
    è·å–å½“å‰é¡¹ç›®ä¸­æ‰€æœ‰å¯ç”¨çš„ä¼˜åŒ–æ–¹æ³•åˆ—è¡¨

    æœ¬å‡½æ•°è¿”å›é¡¹ç›®æ”¯æŒçš„æ‰€æœ‰YOLOv8ä¼˜åŒ–æ–¹æ³•çš„åç§°åˆ—è¡¨ï¼Œ
    ç”¨äºå¸®åŠ©ç”¨æˆ·äº†è§£å¯ç”¨çš„ä¼˜åŒ–é€‰é¡¹ã€‚

    è¿”å›å€¼ï¼š
        list: åŒ…å«æ‰€æœ‰å¯ç”¨ä¼˜åŒ–æ–¹æ³•åç§°çš„å­—ç¬¦ä¸²åˆ—è¡¨
            - 'dcn': å¯å˜å½¢å·ç§¯ç½‘ç»œä¼˜åŒ–
            - 'scc': ç©ºé—´-é€šé“äº¤å‰æ³¨æ„åŠ›ä¼˜åŒ–
            - 'dcn_scc_combined': DCN+SCCç»„åˆä¼˜åŒ–

    ä½¿ç”¨ç¤ºä¾‹ï¼š
        >>> methods = get_available_methods()
        >>> print(f"å¯ç”¨æ–¹æ³•: {methods}")
        å¯ç”¨æ–¹æ³•: ['dcn', 'scc', 'dcn_scc_combined']

    æ³¨æ„äº‹é¡¹ï¼š
        - è¿”å›çš„åˆ—è¡¨é¡ºåºä¸ä»£è¡¨æ€§èƒ½æˆ–æ¨èç¨‹åº¦
        - æ‰€æœ‰æ–¹æ³•éƒ½ç»è¿‡å……åˆ†æµ‹è¯•å’ŒéªŒè¯
        - å¯ä»¥æ ¹æ®å…·ä½“åº”ç”¨åœºæ™¯é€‰æ‹©åˆé€‚çš„æ–¹æ³•
    """
    return ['dcn', 'scc', 'dcn_scc_combined']


def get_method_description(method):
    """
    è·å–æŒ‡å®šä¼˜åŒ–æ–¹æ³•çš„è¯¦ç»†æè¿°ä¿¡æ¯

    æœ¬å‡½æ•°æä¾›æ¯ä¸ªä¼˜åŒ–æ–¹æ³•çš„è¯¦ç»†è¯´æ˜ï¼ŒåŒ…æ‹¬æŠ€æœ¯åŸç†ã€
    é€‚ç”¨åœºæ™¯å’Œä¸»è¦ä¼˜åŠ¿ï¼Œå¸®åŠ©ç”¨æˆ·é€‰æ‹©åˆé€‚çš„ä¼˜åŒ–ç­–ç•¥ã€‚

    å‚æ•°ï¼š
        method (str): ä¼˜åŒ–æ–¹æ³•åç§°ï¼Œå¿…é¡»æ˜¯ä»¥ä¸‹ä¹‹ä¸€ï¼š
            - 'dcn': å¯å˜å½¢å·ç§¯ç½‘ç»œä¼˜åŒ–
            - 'scc': ç©ºé—´-é€šé“äº¤å‰æ³¨æ„åŠ›ä¼˜åŒ–
            - 'dcn_scc_combined': DCN+SCCç»„åˆä¼˜åŒ–

    è¿”å›å€¼ï¼š
        str: è¯¥ä¼˜åŒ–æ–¹æ³•çš„è¯¦ç»†æè¿°ä¿¡æ¯ï¼ŒåŒ…æ‹¬ï¼š
            - æŠ€æœ¯åŸç†ç®€è¿°
            - ä¸»è¦ä¼˜åŠ¿ç‰¹ç‚¹
            - é€‚ç”¨åœºæ™¯è¯´æ˜

    æè¿°å†…å®¹è¯¦è§£ï¼š
        dcn: å¼ºè°ƒå‡ ä½•å»ºæ¨¡èƒ½åŠ›ï¼Œé€‚åˆå¤„ç†å˜å½¢ç‰©ä½“
        scc: å¼ºè°ƒæ³¨æ„åŠ›å¢å¼ºï¼Œé€‚åˆç‰¹å¾è´¨é‡æå‡
        dcn_scc_combined: å¼ºè°ƒååŒæ•ˆåº”ï¼Œé€‚åˆé«˜æ€§èƒ½åº”ç”¨

    å¼‚å¸¸å¤„ç†ï¼š
        - å¦‚æœmethodä¸åœ¨æ”¯æŒåˆ—è¡¨ä¸­ï¼Œè¿”å›"æœªçŸ¥ä¼˜åŒ–æ–¹æ³•"

    ä½¿ç”¨ç¤ºä¾‹ï¼š
        >>> desc = get_method_description('dcn')
        >>> print(desc)
        å¯å˜å½¢å·ç§¯ç½‘ç»œ - é’ˆå¯¹å¯å˜å½¢ç‰©ä½“çš„å‡ ä½•å»ºæ¨¡

        >>> # æ‰¹é‡è·å–æ‰€æœ‰æ–¹æ³•çš„æè¿°
        >>> for method in get_available_methods():
        ...     print(f"{method}: {get_method_description(method)}")

    æ³¨æ„äº‹é¡¹ï¼š
        - æè¿°ä¿¡æ¯ä¼šæ ¹æ®ç‰ˆæœ¬æ›´æ–°è€Œå˜åŒ–
        - å»ºè®®åœ¨é€‰æ‹©æ–¹æ³•å‰è¯¦ç»†é˜…è¯»å„æ–¹æ³•çš„æ–‡æ¡£
        - å¯ä»¥ç»“åˆå…·ä½“åº”ç”¨éœ€æ±‚è¿›è¡Œé€‰æ‹©
    """
    # æ–¹æ³•æè¿°å­—å…¸ï¼šå­˜å‚¨æ‰€æœ‰ä¼˜åŒ–æ–¹æ³•çš„è¯¦ç»†è¯´æ˜
    descriptions = {
        'dcn': 'å¯å˜å½¢å·ç§¯ç½‘ç»œ - å­¦ä¹ å·ç§¯æ ¸çš„ç©ºé—´åç§»ï¼Œå®ç°å¯¹å¯å˜å½¢ç‰©ä½“çš„ç²¾ç¡®å‡ ä½•å»ºæ¨¡',
        'scc': 'ç©ºé—´-é€šé“äº¤å‰æ³¨æ„åŠ› - åŸºäºCBAMæ¶æ„ï¼Œé€šè¿‡æ³¨æ„åŠ›æœºåˆ¶è¿›è¡Œå¤šç»´åº¦ç‰¹å¾å¢å¼º',
        'dcn_scc_combined': 'DCN + SCCç»„åˆä¼˜åŒ– - å°†å‡ ä½•å»ºæ¨¡å’Œæ³¨æ„åŠ›æœºåˆ¶å®Œç¾èåˆï¼Œå®ç°æ£€æµ‹æ€§èƒ½çš„æœ€ä¼˜å¹³è¡¡'
    }

    # è·å–æè¿°ï¼Œå¦‚æœä¸å­˜åœ¨åˆ™è¿”å›é»˜è®¤å€¼
    return descriptions.get(method, 'æœªçŸ¥ä¼˜åŒ–æ–¹æ³•ï¼Œè¯·ä½¿ç”¨get_available_methods()æŸ¥çœ‹æ”¯æŒçš„æ–¹æ³•åˆ—è¡¨')

def create_optimized_model(base_model='yolov8n.yaml', method='dcn_scc_combined', **kwargs):
    """
    åˆ›å»ºç»è¿‡ä¼˜åŒ–å¤„ç†çš„YOLOv8æ¨¡å‹å®ä¾‹

    æœ¬å‡½æ•°æ˜¯æ•´ä¸ªä¼˜åŒ–é¡¹ç›®çš„æ ¸å¿ƒå…¥å£ç‚¹ï¼Œæä¾›äº†ä¸€ä¸ªç»Ÿä¸€ã€é«˜çº§çš„APIæ¥åˆ›å»ºå„ç§ç±»å‹çš„ä¼˜åŒ–YOLOv8æ¨¡å‹ã€‚
    é€šè¿‡ç®€å•çš„å‚æ•°é…ç½®ï¼Œå³å¯è·å¾—é›†æˆä¸åŒä¼˜åŒ–ç­–ç•¥çš„æ¨¡å‹å®ä¾‹ã€‚

    å·¥ä½œåŸç†ï¼š
    =========
    1. åŠ è½½æŒ‡å®šçš„åŸºç¡€YOLOv8æ¨¡å‹
    2. æ ¹æ®methodå‚æ•°é€‰æ‹©å¯¹åº”çš„ä¼˜åŒ–ç­–ç•¥
    3. è¿è¡Œæ—¶åŠ¨æ€æ›¿æ¢æ¨¡å‹ä¸­çš„C2fæ¨¡å—ä¸ºä¼˜åŒ–ç‰ˆæœ¬
    4. è¿”å›ä¼˜åŒ–åçš„å®Œæ•´æ¨¡å‹å®ä¾‹

    å‚æ•°è¯´æ˜ï¼š
    =========
    base_model (str): åŸºç¡€YOLOv8æ¨¡å‹é…ç½®æ–‡ä»¶è·¯å¾„
        - é»˜è®¤: 'yolov8n.yaml' (è½»é‡çº§nanoç‰ˆæœ¬)
        - å¯é€‰: 'yolov8s.yaml', 'yolov8m.yaml', 'yolov8l.yaml', 'yolov8x.yaml'
        - æ”¯æŒ: ç›¸å¯¹è·¯å¾„å’Œç»å¯¹è·¯å¾„

    method (str): ä¼˜åŒ–æ–¹æ³•ç±»å‹ï¼Œé€‰æ‹©å†³å®šæ¨¡å‹çš„ä¼˜åŒ–ç­–ç•¥
        - 'dcn': çº¯DCNä¼˜åŒ–ï¼Œä¸“æ³¨äºå‡ ä½•å»ºæ¨¡
        - 'scc': çº¯SCCä¼˜åŒ–ï¼Œä¸“æ³¨äºæ³¨æ„åŠ›å¢å¼º
        - 'dcn_scc_combined': DCN+SCCç»„åˆä¼˜åŒ–ï¼ˆæ¨èï¼‰
        - é»˜è®¤: 'dcn_scc_combined' (æ€§èƒ½æœ€ä¼˜)

    **kwargs: ä¼ é€’ç»™å…·ä½“ä¼˜åŒ–æ–¹æ³•çš„é¢å¤–é…ç½®å‚æ•°

        DCNæ–¹æ³•å‚æ•° (method='dcn'):
        - target_channels: åº”ç”¨DCNçš„é€šé“æ•°åˆ—è¡¨ï¼Œé»˜è®¤[256, 512]
        - ç¤ºä¾‹: target_channels=[256, 512, 1024]

        SCCæ–¹æ³•å‚æ•° (method='scc'):
        - target_channels: åº”ç”¨SCCçš„é€šé“æ•°åˆ—è¡¨ï¼Œé»˜è®¤[256, 512]
        - enhanced: æ˜¯å¦ä½¿ç”¨å¢å¼ºç‰ˆSCCï¼Œé»˜è®¤False
        - ç¤ºä¾‹: target_channels=[256, 512], enhanced=True

        ç»„åˆæ–¹æ³•å‚æ•° (method='dcn_scc_combined'):
        - target_channels: åº”ç”¨ç»„åˆä¼˜åŒ–çš„é€šé“æ•°åˆ—è¡¨ï¼Œé»˜è®¤[256, 512]
        - mode: ä¼˜åŒ–æ¨¡å¼ï¼Œ'standard'(æ ‡å‡†) æˆ– 'enhanced'(å¢å¼º)ï¼Œé»˜è®¤'standard'
        - ç¤ºä¾‹: target_channels=[256, 512], mode='enhanced'

    è¿”å›å€¼ï¼š
    =======
    YOLO: ç»è¿‡æŒ‡å®šä¼˜åŒ–å¤„ç†åçš„å®Œæ•´YOLOæ¨¡å‹å®ä¾‹
        - ç±»å‹: ultralytics.YOLO
        - çŠ¶æ€: å·²åŠ è½½å¹¶ä¼˜åŒ–ï¼Œå¯ä»¥ç›´æ¥ç”¨äºè®­ç»ƒæˆ–æ¨ç†
        - ç‰¹æ€§: ä¿æŒæ‰€æœ‰æ ‡å‡†YOLOv8 APIå’ŒåŠŸèƒ½

    å¼‚å¸¸å¤„ç†ï¼š
    =========
    ValueError: å½“methodå‚æ•°ä¸åœ¨æ”¯æŒåˆ—è¡¨ä¸­æ—¶æŠ›å‡º
        - é”™è¯¯ä¿¡æ¯åŒ…å«æ‰€æœ‰æ”¯æŒçš„æ–¹æ³•åˆ—è¡¨
        - å»ºè®®ä½¿ç”¨get_available_methods()æŸ¥çœ‹æ”¯æŒæ–¹æ³•

    ImportError: å½“ç›¸å…³æ¨¡å—æ— æ³•å¯¼å…¥æ—¶æŠ›å‡º
        - é€šå¸¸æ˜¯ä¾èµ–åŒ…ç¼ºå¤±æˆ–è·¯å¾„é…ç½®é”™è¯¯
        - æ£€æŸ¥é¡¹ç›®ç»“æ„å’ŒPythonè·¯å¾„è®¾ç½®

    æŠ€æœ¯ç»†èŠ‚ï¼š
    =========
    - æ¨¡å‹åŠ è½½: ä½¿ç”¨Ultralytics YOLOç±»è¿›è¡Œæ¨¡å‹åˆå§‹åŒ–
    - æ¨¡å—æ›¿æ¢: é€šè¿‡ä¸“é—¨çš„æ›¿æ¢å‡½æ•°å®ç°è¿è¡Œæ—¶ä¼˜åŒ–
    - å†…å­˜ç®¡ç†: ä¼˜åŒ–åçš„æ¨¡å‹ä¿æŒä¸åŸæ¨¡å‹ç›¸ä¼¼çš„å†…å­˜å ç”¨
    - å…¼å®¹æ€§: å®Œå…¨å…¼å®¹Ultralyticsçš„æ‰€æœ‰è®­ç»ƒå’Œæ¨ç†API

    æ€§èƒ½å½±å“ï¼š
    =========
    - DCNä¼˜åŒ–: å¢åŠ çº¦20-30%çš„è®¡ç®—å¼€é”€ï¼Œæå‡å‡ ä½•å»ºæ¨¡èƒ½åŠ›
    - SCCä¼˜åŒ–: å¢åŠ çº¦10-15%çš„è®¡ç®—å¼€é”€ï¼Œæå‡ç‰¹å¾è´¨é‡
    - ç»„åˆä¼˜åŒ–: å¢åŠ çº¦30-40%çš„è®¡ç®—å¼€é”€ï¼Œå®ç°æ€§èƒ½æœ€ä¼˜åŒ–

    ä½¿ç”¨å»ºè®®ï¼š
    =========
    1. åˆæ¬¡ä½¿ç”¨å»ºè®®é€‰æ‹©ç»„åˆä¼˜åŒ–è·å¾—æœ€ä½³æ•ˆæœ
    2. æ ¹æ®å…·ä½“åº”ç”¨åœºæ™¯é€‰æ‹©åˆé€‚çš„ä¼˜åŒ–ç­–ç•¥
    3. å¯ä»¥å…ˆç”¨å°æ•°æ®é›†æµ‹è¯•ä¼˜åŒ–æ•ˆæœå†æ‰©å±•åº”ç”¨
    4. ç”Ÿäº§ç¯å¢ƒå»ºè®®è¿›è¡Œå……åˆ†çš„æ€§èƒ½æµ‹è¯•

    å®Œæ•´ç¤ºä¾‹ï¼š
    =========
    >>> # åŸºç¡€ä½¿ç”¨ - åˆ›å»ºé»˜è®¤ç»„åˆä¼˜åŒ–æ¨¡å‹
    >>> model = create_optimized_model()
    >>> results = model.train(data='your_dataset.yaml')

    >>> # DCNä¸“ç”¨ä¼˜åŒ– - å‡ ä½•å»ºæ¨¡å¢å¼º
    >>> model_dcn = create_optimized_model(
    ...     base_model='yolov8s.yaml',
    ...     method='dcn',
    ...     target_channels=[256, 512, 1024]  # åŒ…å«æ›´å¤šå±‚çº§
    ... )

    >>> # SCCå¢å¼ºä¼˜åŒ– - æ³¨æ„åŠ›æœºåˆ¶åŠ å¼º
    >>> model_scc = create_optimized_model(
    ...     base_model='yolov8m.yaml',
    ...     method='scc',
    ...     target_channels=[256, 512],
    ...     enhanced=True  # å¯ç”¨å¢å¼ºç‰ˆSCC
    ... )

    >>> # é«˜çº§ç»„åˆä¼˜åŒ– - æ€§èƒ½æœ€ä¼˜åŒ–
    >>> model_combined = create_optimized_model(
    ...     base_model='yolov8l.yaml',
    ...     method='dcn_scc_combined',
    ...     target_channels=[256, 512],
    ...     mode='enhanced'  # ä½¿ç”¨å¢å¼ºæ¨¡å¼
    ... )

    >>> # æ‰¹é‡åˆ›å»ºä¸åŒä¼˜åŒ–æ¨¡å‹è¿›è¡Œå¯¹æ¯”
    >>> methods = get_available_methods()
    >>> models = {}
    >>> for method in methods:
    ...     models[method] = create_optimized_model(method=method)
    ...     print(f"åˆ›å»º{method}ä¼˜åŒ–æ¨¡å‹æˆåŠŸ")

    æ³¨æ„äº‹é¡¹ï¼š
    =========
    - ç¡®ä¿ç³»ç»Ÿå·²å®‰è£…Ultralyticså’Œç›¸å…³ä¾èµ–
    - GPUç¯å¢ƒå¯ä»¥æ˜¾è‘—æå‡ä¼˜åŒ–è¿‡ç¨‹çš„é€Ÿåº¦
    - å¤§æ¨¡å‹ä¼˜åŒ–å¯èƒ½éœ€è¦æ›´å¤šè®¡ç®—èµ„æº
    - å»ºè®®åœ¨ä¼˜åŒ–åè¿›è¡Œå……åˆ†çš„éªŒè¯æµ‹è¯•
    """
    # å¯¼å…¥Ultralytics YOLOç±»
    from ultralytics import YOLO

    # æ­¥éª¤1: åŠ è½½æŒ‡å®šçš„åŸºç¡€YOLOv8æ¨¡å‹
    print(f"ğŸ”§ åŠ è½½åŸºç¡€æ¨¡å‹: {base_model}")
    model = YOLO(base_model)

    # æ­¥éª¤2: æ ¹æ®æ–¹æ³•é€‰æ‹©åº”ç”¨ç›¸åº”çš„ä¼˜åŒ–ç­–ç•¥
    print(f"ğŸ¯ åº”ç”¨ä¼˜åŒ–æ–¹æ³•: {method}")

    if method == 'dcn':
        # DCNä¼˜åŒ–åˆ†æ”¯ï¼šä¸“æ³¨äºå‡ ä½•å»ºæ¨¡èƒ½åŠ›çš„æå‡
        print("   ğŸ“ æ­£åœ¨åº”ç”¨DCNå¯å˜å½¢å·ç§¯ç½‘ç»œä¼˜åŒ–...")
        from .dcn.dcn_c2f import replace_c2f_with_dcn
        model = replace_c2f_with_dcn(model, **kwargs)
        print("   âœ… DCNä¼˜åŒ–åº”ç”¨æˆåŠŸ")

    elif method == 'scc':
        # SCCä¼˜åŒ–åˆ†æ”¯ï¼šä¸“æ³¨äºæ³¨æ„åŠ›æœºåˆ¶çš„å¢å¼º
        print("   ğŸ§  æ­£åœ¨åº”ç”¨SCCç©ºé—´-é€šé“äº¤å‰æ³¨æ„åŠ›ä¼˜åŒ–...")
        from .scc.scc_c2f import replace_c2f_with_scc
        model = replace_c2f_with_scc(model, **kwargs)
        print("   âœ… SCCä¼˜åŒ–åº”ç”¨æˆåŠŸ")

    elif method == 'dcn_scc_combined':
        # ç»„åˆä¼˜åŒ–åˆ†æ”¯ï¼šå‡ ä½•å»ºæ¨¡+æ³¨æ„åŠ›å¢å¼ºçš„åŒé‡ä¼˜åŒ–
        print("   âš¡ æ­£åœ¨åº”ç”¨DCN+SCCç»„åˆä¼˜åŒ–...")
        from .dcn_scc_combined.dcn_scc_c2f import replace_c2f_with_dcn_scc
        model = replace_c2f_with_dcn_scc(model, **kwargs)
        print("   âœ… DCN+SCCç»„åˆä¼˜åŒ–åº”ç”¨æˆåŠŸ")

    else:
        # é”™è¯¯å¤„ç†ï¼šä¸æ”¯æŒçš„ä¼˜åŒ–æ–¹æ³•
        available_methods = get_available_methods()
        error_msg = f"æœªçŸ¥çš„ä¼˜åŒ–æ–¹æ³•: '{method}'ã€‚æ”¯æŒçš„æ–¹æ³•: {available_methods}"
        raise ValueError(error_msg)

    # æ­¥éª¤3: è¿”å›ä¼˜åŒ–åçš„æ¨¡å‹
    print(f"ğŸ‰ ä¼˜åŒ–æ¨¡å‹åˆ›å»ºå®Œæˆï¼æ¨¡å‹ç±»å‹: {type(model).__name__}")
    return model

# ä¸»ç¨‹åºå…¥å£ - é¡¹ç›®ä¿¡æ¯å±•ç¤ºå’Œä½¿ç”¨ç¤ºä¾‹
if __name__ == "__main__":
    """
    æ¨¡å—ä¸»ç¨‹åºï¼šå±•ç¤ºé¡¹ç›®ä¿¡æ¯å’ŒåŸºæœ¬ä½¿ç”¨æ–¹æ³•

    å½“ç›´æ¥è¿è¡Œæ­¤æ¨¡å—æ—¶ï¼Œä¼šæ˜¾ç¤ºé¡¹ç›®çš„åŸºæœ¬ä¿¡æ¯å’Œä½¿ç”¨ç¤ºä¾‹ï¼Œ
    å¸®åŠ©ç”¨æˆ·å¿«é€Ÿäº†è§£é¡¹ç›®çš„åŠŸèƒ½å’Œä½¿ç”¨æ–¹æ³•ã€‚

    æ˜¾ç¤ºå†…å®¹ï¼š
    =========
    - é¡¹ç›®æ ‡é¢˜å’Œç‰ˆæœ¬ä¿¡æ¯
    - å¯ç”¨çš„ä¼˜åŒ–æ–¹æ³•åˆ—è¡¨
    - å¿«é€Ÿå¼€å§‹çš„ä½¿ç”¨ç¤ºä¾‹
    - é‡è¦åŠŸèƒ½ç‰¹æ€§ä»‹ç»

    æ‰§è¡Œæµç¨‹ï¼š
    =========
    1. æ˜¾ç¤ºé¡¹ç›®æ ‡é¢˜å’ŒåŸºæœ¬ä¿¡æ¯
    2. å±•ç¤ºæ‰€æœ‰å¯ç”¨çš„ä¼˜åŒ–æ–¹æ³•
    3. æä¾›å¿«é€Ÿä½¿ç”¨çš„ä»£ç ç¤ºä¾‹
    4. ç»™å‡ºè¿›ä¸€æ­¥ä½¿ç”¨çš„æŒ‡å¯¼å»ºè®®

    è¾“å‡ºç¤ºä¾‹ï¼š
    =========
    ğŸ¯ YOLOv8ä¼˜åŒ–ç¤ºä¾‹é¡¹ç›®
    ==================================================
    ç‰ˆæœ¬: 1.0.0
    å¯ç”¨ä¼˜åŒ–æ–¹æ³•: ['dcn', 'scc', 'dcn_scc_combined']

    å¿«é€Ÿä½¿ç”¨ç¤ºä¾‹:
    from optimization_examples import create_optimized_model
    model = create_optimized_model(method='dcn_scc_combined')
    results = model.train(data='your_dataset.yaml', epochs=100)

    ğŸ’¡ ä½¿ç”¨å»ºè®®:
    - æ¨èä»ç»„åˆä¼˜åŒ–å¼€å§‹è·å¾—æœ€ä½³æ€§èƒ½
    - ä½¿ç”¨run_all_examples.pyè¿è¡Œå®Œæ•´ç¤ºä¾‹
    - æŸ¥çœ‹å„å­æ¨¡å—æ–‡æ¡£äº†è§£è¯¦ç»†ä¿¡æ¯
    """
    print("ğŸ¯ YOLOv8ä¼˜åŒ–ç¤ºä¾‹é¡¹ç›®")
    print("=" * 50)
    print(f"ğŸ“¦ ç‰ˆæœ¬: {__version__}")
    print(f"ğŸ‘¨â€ğŸ’» ä½œè€…: {__author__}")
    print(f"ğŸ“‹ å¯ç”¨ä¼˜åŒ–æ–¹æ³•: {get_available_methods()}")

    print("\nğŸš€ å¿«é€Ÿå¼€å§‹ä½¿ç”¨:")
    print("from optimization_examples import create_optimized_model")
    print("model = create_optimized_model(method='dcn_scc_combined')")
    print("results = model.train(data='your_dataset.yaml', epochs=100)")

    print("\nğŸ“š æ›´å¤šä½¿ç”¨æ–¹å¼:")
    print("â€¢ è¿è¡Œç¤ºä¾‹: python run_all_examples.py --method all")
    print("â€¢ æ¶ˆèå®éªŒ: python run_all_examples.py --ablation")
    print("â€¢ æ¨¡å—æµ‹è¯•: python run_all_examples.py --test")

    print("\nğŸ’¡ ä½¿ç”¨å»ºè®®:")
    print("â€¢ ğŸ† æ¨èä»'dcn_scc_combined'ç»„åˆä¼˜åŒ–å¼€å§‹è·å¾—æœ€ä½³æ€§èƒ½")
    print("â€¢ ğŸ”¬ ä½¿ç”¨æ¶ˆèå®éªŒæ¯”è¾ƒä¸åŒæ–¹æ³•çš„æ€§èƒ½å·®å¼‚")
    print("â€¢ ğŸ“– æŸ¥çœ‹å„å­æ¨¡å—çš„è¯¦ç»†æ–‡æ¡£äº†è§£å…·ä½“å®ç°")
    print("â€¢ âš¡ GPUç¯å¢ƒå¯ä»¥æ˜¾è‘—æå‡è®­ç»ƒå’Œæ¨ç†é€Ÿåº¦")

    print("\nğŸ¯ é¡¹ç›®ç‰¹è‰²:")
    print("â€¢ æ¨¡å—åŒ–è®¾è®¡ï¼Œæ”¯æŒçµæ´»ç»„åˆ")
    print("â€¢ ç»Ÿä¸€çš„APIæ¥å£ï¼Œä¾¿äºä½¿ç”¨")
    print("â€¢ å®Œæ•´çš„æŠ€æœ¯æ–‡æ¡£å’Œç¤ºä¾‹")
    print("â€¢ ç”Ÿäº§çº§åˆ«çš„ä»£ç è´¨é‡å’Œæ€§èƒ½")
